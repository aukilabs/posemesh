[package]
name = "posemesh-networking"
version = "0.1.0"
edition = "2021"

[dependencies]
futures = "0.3.30"
lazy_static = "1.5.0"
libp2p-stream = { git = "https://github.com/aukilabs/rust-libp2p.git", rev = "eee1374" }
serde = { version = "1.0.210", features = ["derive"] }
serde_json = "1.0.128"
tracing = "0.1.40"
tracing-subscriber = { version = "0.3.18", features = ["env-filter"] }

libp2p = { git = "https://github.com/aukilabs/rust-libp2p.git", rev = "eee1374", default-features = false }
tokio = { version = "1.40.0", features = ["full"], optional = true }
rand = { version = "0.8.5", optional = true }
libp2p-webrtc = { git = "https://github.com/aukilabs/rust-libp2p.git", rev = "eee1374", features = ["tokio"], optional = true }
libp2p-webrtc-websys = { git = "https://github.com/aukilabs/rust-libp2p.git", rev = "eee1374", optional = true }
tracing-wasm = { version = "0.2.1", optional = true }
wasm-bindgen = { version = "0.2.90", optional = true }
wasm-bindgen-futures = { version = "0.4.42", optional = true }
serde-wasm-bindgen = { version = "0.6.5", optional = true }
js-sys = { version = "0.3.72", optional = true }

[features]
default = ["native"]
wasm = [
    "libp2p/wasm-bindgen",
    "libp2p/macros",
    "libp2p/gossipsub",
    "libp2p/serde",
    "libp2p/identify",
    "libp2p/kad",
    "dep:libp2p-webrtc-websys",
    "dep:tracing-wasm",
    "dep:wasm-bindgen",
    "dep:wasm-bindgen-futures",
    "dep:serde-wasm-bindgen",
    "dep:js-sys"
]
native = [
    "dep:tokio",
    "dep:rand",
    "dep:libp2p-webrtc",
    "libp2p/tokio",
    "libp2p/gossipsub",
    "libp2p/mdns",
    "libp2p/noise",
    "libp2p/macros",
    "libp2p/tcp",
    "libp2p/yamux",
    "libp2p/quic",
    "libp2p/serde",
    "libp2p/relay",
    "libp2p/identify",
    "libp2p/kad",
    "libp2p/dns"
]

[lib]
crate-type = ["cdylib", "staticlib"]
